const translations = {
  fr: {
    global: {
      'nav.primary': 'Navigation principale',
      'nav.toggle': 'Basculer la navigation',
      'nav.home': 'Accueil',
      'nav.create': 'Excursions',
      'nav.reviews': 'Avis',
      'nav.story': 'Notre histoire',
      'footer.rights': 'Â© 2025 QuÃ©bec Mexique (A beyondthereefmexico brand). Tous droits rÃ©servÃ©s.',
      'floatingContact.aria': 'Options de contact rapide',
      'floatingContact.whatsappAria': 'Discuter sur WhatsApp',
      'floatingContact.emailAria': 'Envoyer un courriel Ã  QuÃ©bec Mexique',
      'floatingContact.instagramAria': 'Ouvrir Instagram',
      'floatingContact.whatsappLabel': 'WhatsApp',
      'floatingContact.emailLabel': 'Courriel',
      'floatingContact.instagramLabel': 'Instagram',
      'heroSlider.goToSlide': 'Aller Ã  la diapositive {{index}}',
      'tourBuilder.remove': 'Retirer',
      'inquiry.emailSubject': 'IdÃ©e de journÃ©e sur mesure de {{name}}',
      'inquiry.emailBody.nameLabel': 'Nom',
      'inquiry.emailBody.emailLabel': 'Courriel',
      'inquiry.emailBody.phoneLabel': 'TÃ©lÃ©phone',
      'inquiry.emailBody.ideaLabel': 'IdÃ©e de voyage',
      'inquiry.status.missing':
        'Veuillez ajouter votre nom, votre courriel et votre idÃ©e afin que nous puissions prÃ©parer votre devis.',
      'inquiry.status.sending': 'Nous envoyons votre demande Ã  notre Ã©quipe concierge.',
      'inquiry.status.sent': 'Merci! Votre demande est reÃ§ue. Nous vous rÃ©pondons sous peu.',
      'inquiry.status.error': 'Une erreur est survenue lors de lâ€™envoi. Veuillez rÃ©essayer.',
      'inquiry.status.unavailable': 'Impossible dâ€™envoyer votre demande pour le moment. RÃ©essayez dans quelques instants.',
      'inquiry.status.missingService':
        'Veuillez connecter ce formulaire Ã  un service de courriel pour recevoir les demandes.',
      'tour.card.viewDetails': 'Voir les dÃ©tails',
      'tour.card.bookNow': 'RÃ©server',
      'tour.card.privateBadge': 'Excursion privÃ©e',
      'tour.card.halfDay': 'Demi-journÃ©e',
      'tour.card.fullDay': 'JournÃ©e complÃ¨te',
      'tour.card.viewAria': 'Voir {{name}}'
    },
    home: {
      'page.title': 'QuÃ©bec Mexique',
      'home.hero.aria': 'ExpÃ©riences Ã  la une',
      'home.hero.heading': 'AdrÃ©naline pure. Nature indomptÃ©e. Votre histoire en train de sâ€™Ã©crire.',
      'home.hero.description':
        'Pas juste une sortie : câ€™est la libertÃ© totale. Nagez avec les tortues, plongez dans les cenotes, filez Ã  travers les lagunes et explorez dâ€™anciennes ruines mayas. Pas de foule. Pas de limites. Juste lâ€™aventure brute au cÅ“ur de la Riviera Maya. Vos rÃ¨gles. Votre rythme. Votre souvenir inoubliable. Ce nâ€™est pas du tourisme. Câ€™est QuÃ©bec Mexique.',
      'home.hero.cta': 'Voir toutes nos excursions privÃ©es',
      'home.hero.previous': 'Diapositive prÃ©cÃ©dente',
      'home.hero.next': 'Diapositive suivante',
      'home.hero.dots': 'Diapositives vedettes',
      'home.difference.heading': 'Vivez la diffÃ©rence',
      'home.difference.captured.title': 'ImmortalisÃ©',
      'home.difference.captured.copy':
        'Photos offertes gratuitement Ã  chaque excursion PrivÃ©e (Promo non valide pour tour avec transport partagÃ©)',
      'home.difference.pace.title': 'Ã€ votre rythme',
      'home.difference.pace.copy': 'Choisissez votre heure de dÃ©part, Ã©vitez les prises en charge, crÃ©ez votre horaire',
      'home.difference.journey.title': 'Votre aventure',
      'home.difference.journey.copy': 'Snorkel, exploration, saveurs, dÃ©tente â€” Ã  vous de choisir',
      'home.difference.surprises.title': 'Sans surprises',
      'home.difference.surprises.copy': 'Aucun coÃ»t cachÃ©, aucun extra, juste lâ€™aventure',
      'home.difference.excellence.title': 'Excellence',
      'home.difference.excellence.copy': 'Ce nâ€™est pas nous qui le disons : nos invitÃ©s. Cinq Ã©toiles, toujours.',
      'home.favorites.heading': 'Aventures adorÃ©es par nos voyageurs',
      'home.favorites.copy':
        'Faites dÃ©filer les offres Ã  durÃ©e limitÃ©e sur les excursions que nos invitÃ©s adorent le plus.',
      'home.favorites.previous': 'Excursions prÃ©cÃ©dentes',
      'home.favorites.next': 'Excursions suivantes',
      'home.favorites.card1.tag': 'Coup de cÅ“ur',
      'home.favorites.card1.title': 'Nage avec les requins-baleines',
      'home.favorites.card1.badge': '-30 %',
      'home.favorites.card1.deal': 'Jusquâ€™Ã  30 % de rabais',
      'home.favorites.card1.copy':
        'AffrÃ©tez un bateau privÃ© avec des guides biologistes marins et glissez dans lâ€™eau avec ces gÃ©ants paisibles au lever du soleil.',
      'home.favorites.card1.cta': 'Plus dâ€™infos',
      'home.favorites.card2.tag': 'Favori des invitÃ©s',
      'home.favorites.card2.title': 'Le Taco Tour',
      'home.favorites.card2.badge': '-25 %',
      'home.favorites.card2.deal': 'Jusquâ€™Ã  25 % de rabais',
      'home.favorites.card2.copy':
        'GoÃ»tez aux taquerÃ­as cachÃ©es avec un hÃ´te local qui marie les mezcals et les lÃ©gendes de rue.',
      'home.favorites.card2.cta': 'Plus dâ€™infos',
      'home.favorites.card3.tag': 'Places limitÃ©es',
      'home.favorites.card3.title': 'Snorkel Ã  El Cielo Cozumel',
      'home.favorites.card3.badge': '-22 %',
      'home.favorites.card3.deal': 'Jusquâ€™Ã  22 % de rabais',
      'home.favorites.card3.copy':
        'Flottez au-dessus des jardins dâ€™Ã©toiles de mer et des rÃ©cifs Ã©clatants Ã  Cozumel avec un capitaine qui choisit le banc de sable Ã  son meilleur.',
      'home.favorites.card3.cta': 'Plus dâ€™infos',
      'home.favorites.card4.tag': 'PrÃªt pour les photos',
      'home.favorites.card4.title': 'ExpÃ©rience Insta Ã  Tulum',
      'home.favorites.card4.badge': '-18 %',
      'home.favorites.card4.deal': 'Jusquâ€™Ã  18 % de rabais',
      'home.favorites.card4.copy':
        'Capturez des images cinÃ©matographiques dans les ruines et les cenotes de Tulum avec une direction artistique pour chaque moment.',
      'home.favorites.card4.cta': 'Plus dâ€™infos',
      'home.builder.eyebrow': 'Planifiez avec notre Ã©quipe concierge',
      'home.builder.heading': 'On crÃ©e votre journÃ©e parfaite',
      'home.builder.copy':
        'Partagez votre idÃ©e par courriel et recevez un devis personnalisÃ©, ou rÃ©servez un appel vidÃ©o pour peaufiner chaque dÃ©tail.',
      'home.builder.formAria': 'Envoyer les dÃ©tails de votre journÃ©e idÃ©ale',
      'home.builder.nameLabel': 'Nom',
      'home.builder.namePlaceholder': 'Votre nom',
      'home.builder.emailLabel': 'Courriel',
      'home.builder.emailPlaceholder': 'vous@exemple.com',
      'home.builder.phoneLabel': 'TÃ©lÃ©phone',
      'home.builder.phonePlaceholder': '+52 1 555 555 5555',
      'home.builder.notesLabel': 'Parlez-nous de votre idÃ©e',
      'home.builder.notesPlaceholder': 'Indiquez la date, lâ€™ambiance et les incontournables.',
      'home.builder.submit': 'Envoyer mon idÃ©e',
      'home.builder.listHeading': 'Parlez-nous de votre journÃ©e rÃªvÃ©e',
      'home.builder.pointOne':
        'Partagez lâ€™ambiance souhaitÃ©e : relax, pleine dâ€™Ã©nergie, romantique ou hors rÃ©seau.',
      'home.builder.pointTwo': 'Ajoutez les activitÃ©s incontournables, le style de repas ou vos prÃ©fÃ©rences dâ€™horaire.',
      'home.builder.pointThree':
        'Vous recevrez un devis personnalisÃ© ou lâ€™option de discuter en vidÃ©o avec notre Ã©quipe.',
      'home.builder.emailFallback':
        'Vous prÃ©fÃ©rez le courriel? Ã‰crivez-nous Ã  <a href="mailto:info@quebecmexique.com">info@quebecmexique.com</a>.',
      'home.builder.emailSubject': 'IdÃ©e de journÃ©e sur mesure de {{name}}',
      'home.builder.status.missing':
        'Veuillez ajouter votre nom, votre courriel et votre idÃ©e afin que nous puissions prÃ©parer votre devis.',
      'home.builder.status.prompt': 'Ouverture de votre appli courriel pour envoyer les dÃ©tails Ã  notre concierge.',
      'home.accent.eyebrow': 'Pourquoi on nous choisit',
      'home.accent.heading': 'Excursions privÃ©es, sans stress',
      'home.accent.locals.title': 'Guides certifiÃ©s',
      'home.accent.locals.copy':
        'Nos guides certifiÃ©s cumulent des annÃ©es dâ€™expÃ©rience et crÃ©ent des moments privilÃ©giÃ©s introuvables dans les brochures.',
      'home.accent.collab.title': 'Vous ne trouvez pas lâ€™excursion parfaite?',
      'home.accent.collab.copy':
        'Ã‰crivez-nous et nous planifierons un appel ou une visioconfÃ©rence pour crÃ©er votre excursion idÃ©ale.',
      'home.accent.execution.title': 'Excursions sans souci',
      'home.accent.execution.copy':
        'Votre excursion, votre horaire, sans frais cachÃ©s : transferts, billets et horaires sont gÃ©rÃ©s pour que vous profitiez.',
      'home.cta.heading': 'PrÃªt Ã  crÃ©er votre excursion de rÃªve?',
      'home.cta.copy': 'Ã‰crivez-nous et nous crÃ©erons lâ€™expÃ©rience parfaite pour vous.',
      'home.cta.button': 'Nous Ã©crire maintenant'
    },
    tours: {
      'page.title': 'Excursions et visites privÃ©es | QuÃ©bec Mexique',
      'tours.hero.aria': 'AperÃ§u des excursions',
      'tours.hero.previous': 'Diapositive prÃ©cÃ©dente',
      'tours.hero.next': 'Diapositive suivante',
      'tours.hero.dots': 'Diapositives des excursions',
      'tours.hero.eyebrow': 'CrÃ©ez votre excursion',
      'tours.hero.heading': 'Des expÃ©riences aussi uniques que votre groupe',
      'tours.hero.copy':
        'Glissez-dÃ©posez des activitÃ©s sÃ©lectionnÃ©es, ajustez le rythme et invitez vos compagnons de voyage Ã  collaborer en temps rÃ©el.',
      'tours.assurance.eyebrow': 'Seulement vous et les gens que vous aimez',
      'tours.assurance.heading': 'Plus de 14 ans dâ€™expÃ©rience en excursions',
      'tours.assurance.copy':
        '<span class="assurance-line">Les vans les plus rÃ©centes de lâ€™industrie</span><span class="assurance-line">Guides certifiÃ©s</span><span class="assurance-line">Repas sÃ©curitaires pour allergies et diÃ¨tes spÃ©ciales</span>',
      'tours.assurance.item1.title': 'Flotte privÃ©e et vans modernes',
      'tours.assurance.item1.copy':
        'Voyagez dans nos vans les plus rÃ©centes avec A/C froide, siÃ¨ges en cuir, capitaines pros et aucun groupe partagÃ©.',
      'tours.assurance.item2.title': 'Guides certifiÃ©s et professionnels',
      'tours.assurance.item2.copy':
        'Des guides certifiÃ©s et bilingues mÃ¨nent chaque excursion avec des protocoles axÃ©s sur la sÃ©curitÃ©.',
      'tours.assurance.item3.title': 'Nourriture sÃ©curitaire pour chaque diÃ¨te',
      'tours.assurance.item3.copy':
        'Nous incluons des repas frais et adaptons les menus pour vÃ©gans, sans gluten, allergies et demandes spÃ©ciales.',
      'tours.grid.eyebrow': 'Voir toutes les excursions rapidement',
      'tours.grid.heading': 'Nos excursions privÃ©es les plus populaires',
      'tours.grid.custom.title': 'Combinaisons sur mesure',
      'tours.grid.custom.copy':
        'MÃ©langez plongÃ©es, surprises culinaires et randonnÃ©es isolÃ©es. Notre planificateur intelligent orchestre la logistique.',
      'tours.grid.pacing.title': 'Rythme Ã©quilibrÃ©',
      'tours.grid.pacing.copy':
        'Nous Ã©quilibrons les aventures Ã©nergiques avec des pauses rÃ©paratrices pour que chacun recharge ses batteries.',
      'tours.grid.collab.title': 'Co-crÃ©ez en direct',
      'tours.grid.collab.copy':
        'Partagez un lien privÃ© pour que votre groupe vote, commente ou ajoute des idÃ©es. Nos concierges ajustent en direct.',
      'tours.steps.heading': 'Comment fonctionne le crÃ©ateur sur mesure',
      'tours.steps.one.title': 'Parlez-nous de votre rÃªve',
      'tours.steps.one.copy': 'RÃ©pondez Ã  quelques questions ou partagez un moodboard. On prÃ©-sÃ©lectionne les expÃ©riences.',
      'tours.steps.two.title': 'Ajustez le plan',
      'tours.steps.two.copy':
        'DÃ©placez les activitÃ©s, ajustez les horaires et ajoutez des demandes spÃ©ciales comme un photographe privÃ©.',
      'tours.steps.three.title': 'Validez le tout',
      'tours.steps.three.copy':
        'Collaborez avec votre concierge pour finaliser les transferts, paiements et lâ€™assistance sur place.',
      'tours.contact.eyebrow': 'Votre excursion sur mesure',
      'tours.contact.heading': 'Vous voulez une excursion qui nâ€™est pas dans la liste?',
      'tours.contact.copy':
        'Indiquez la date et toute diÃ¨te spÃ©ciale ou besoin dâ€™accessibilitÃ© : on la conÃ§oit, on la chiffre et on confirme vite.',
      'tours.contact.point1': 'Promo combo : rÃ©servez 3 excursions et Ã©conomisez de 20 % Ã  30 %.',
      'tours.contact.point2': 'Service 100 % privÃ© avec vans neuves, capitaines pros et guides certifiÃ©s.',
      'tours.contact.point3': 'Normes de nourriture sÃ©curitaire avec menus adaptÃ©s aux vÃ©gans, sans gluten et allergies.',
      'tours.contact.channels':
        'Vous prÃ©fÃ©rez un contact direct? Ã‰crivez Ã  <a href="mailto:info@quebecmexique.com">info@quebecmexique.com</a> ou WhatsApp <a href="https://wa.me/529841670697" target="_blank" rel="noopener noreferrer">+52 984 167 0697</a>.',
      'tours.contact.formAria': 'Partagez lâ€™excursion souhaitÃ©e',
      'tours.contact.nameLabel': 'Nom',
      'tours.contact.namePlaceholder': 'Votre nom',
      'tours.contact.emailLabel': 'Courriel',
      'tours.contact.emailPlaceholder': 'vous@exemple.com',
      'tours.contact.phoneLabel': 'TÃ©lÃ©phone',
      'tours.contact.phonePlaceholder': '+52 1 555 555 5555',
      'tours.contact.ideaLabel': 'Parlez-nous de votre idÃ©e',
      'tours.contact.ideaPlaceholder': 'Ajoutez la date, lâ€™ambiance, les diÃ¨tes et les incontournables.',
      'tours.contact.submit': 'Envoyer mon idÃ©e'
    },
    reviews: {
      'page.title': 'Avis des voyageurs | QuÃ©bec Mexique',
      'reviews.hero.eyebrow': 'Lettres dâ€™amour de nos voyageurs',
      'reviews.hero.heading': 'Histoires de voyageurs qui sont allÃ©s plus loin',
      'reviews.hero.copy':
        'DÃ©couvrez comment des voyages sur mesure et des attentions bien pensÃ©es ont transformÃ© des rÃªves en escapades sans effort.',
      'reviews.featured.heading': 'Avis en vedette',
      'reviews.featured.one.title': 'â€œIls ont pensÃ© Ã  chaque dÃ©tail.â€',
      'reviews.featured.one.copy':
        'â€œDe la nage nocturne avec les raies manta au souper surprise dâ€™anniversaire sur un banc de sable, lâ€™Ã©quipe de QuÃ©bec Mexique a tout dÃ©passÃ©. On nâ€™a jamais regardÃ© lâ€™heure.â€ - <strong>Cam &amp; Jordan</strong>',
      'reviews.featured.two.title': 'â€œPlanifier, câ€™Ã©tait vraiment le fun.â€',
      'reviews.featured.two.copy':
        'â€œOn a bÃ¢ti lâ€™itinÃ©raire ensemble en appel vidÃ©o et on voyait les disponibilitÃ©s en direct. Leur concierge a rÃ©servÃ© un guide privÃ© pour mon pÃ¨re afin quâ€™il explore Ã  son rythme.â€ - <strong>Riya</strong>',
      'reviews.featured.three.title': 'â€œNos amis en parlent encore.â€',
      'reviews.featured.three.copy':
        'â€œLe chat de groupe dÃ©bordait dâ€™idÃ©es. Le planificateur de QuÃ©bec Mexique a tout gardÃ© organisÃ© et a mÃªme ajoutÃ© des cours de mixologie inspirÃ©s de notre liste Spotify.â€ - <strong>Diego &amp; crew</strong>',
      'reviews.featured.four.title': 'â€œChichÃ©n ItzÃ¡ sans stress.â€',
      'reviews.featured.four.copy':
        'â€œIls ont planifiÃ© lâ€™entrÃ©e au lever du soleil pour avoir El Castillo presque Ã  nous, avec un guide passionnÃ© dâ€™histoire. Les tacos du dÃ©jeuner Ã©taient un moment fort.â€ - <strong>Mariela &amp; TomÃ¡s</strong>',
      'reviews.featured.five.title': 'â€œPÃªche en famille, facile.â€',
      'reviews.featured.five.copy':
        'â€œQuÃ©bec Mexique a rempli la glaciÃ¨re, gÃ©rÃ© les permis et nous a jumelÃ©s Ã  un capitaine patient pour que nos enfants attrapent leur premier mahi. ZÃ©ro stress, juste des sourires.â€ - <strong>The Greene crew</strong>',
      'reviews.featured.six.title': 'â€œParfaite tournÃ©e de tacos de rue.â€',
      'reviews.featured.six.copy':
        'â€œOn a mangÃ© au centre-ville : al pastor, cochinita, birria, sans jamais faire la file. Notre hÃ´te connaissait les vendeurs par leur prÃ©nom et a trouvÃ© des options vÃ©gÃ©s pour mon amie.â€ - <strong>Avery</strong>',
      'reviews.featured.seven.title': 'â€œCenote sans foule.â€',
      'reviews.featured.seven.copy':
        'â€œIls ont trouvÃ© un cenote cachÃ© et ont calÃ© notre arrivÃ©e entre les autobus. On flottait dans une eau cristalline avec seulement les oiseaux en fond. Serviettes, collations et photos Ã©taient gÃ©rÃ©es.â€ - <strong>Jess &amp; Priya</strong>',
      'reviews.featured.eight.title': 'â€œSnorkel digne dâ€™un documentaire.â€',
      'reviews.featured.eight.copy':
        'â€œNotre guide a pointÃ© tortues, raies et mÃªme un petit hippocampe timide. Lâ€™Ã©quipement Ã©tait parfait et le bateau avait de lâ€™ombre, ce que mon pÃ¨re a apprÃ©ciÃ©. Ils se sont occupÃ©s de tout.â€ - <strong>Samir</strong>',
      'reviews.featured.nine.title': 'â€œSoirÃ©e tacos romantique sur la plage.â€',
      'reviews.featured.nine.copy':
        'â€œIls ont transformÃ© une envie en soirÃ©e complÃ¨te : tacos grillÃ©s, aguas frescas et lumiÃ¨res sous les palmiers. Câ€™Ã©tait notre date prÃ©fÃ©rÃ©e du voyage.â€ - <strong>Lena &amp; Marco</strong>',
      'reviews.featured.ten.title': 'â€œAventure accessible, bien organisÃ©e.â€',
      'reviews.featured.ten.copy':
        'â€œJâ€™utilise un fauteuil roulant et ils ont coordonnÃ© rampes, transport et un guide patient pour Tulum. Je nâ€™ai jamais eu Ã  rÃ©pÃ©ter quoi que ce soit. Tout a roulÃ©.â€ - <strong>Natalie</strong>',
      'reviews.featured.eleven.title': 'â€œCours de pÃªche sous-marine trÃ¨s personnalisÃ©s.â€',
      'reviews.featured.eleven.copy':
        'â€œOn voulait apprendre en sÃ©curitÃ© et ils nous ont jumelÃ©s Ã  un expert local axÃ© sur la technique et le respect du rÃ©cif. On est repartis avec de nouvelles compÃ©tences et un dÃ®ner prÃ©parÃ© avec notre prise.â€ - <strong>Darius &amp; Cole</strong>',
      'reviews.featured.twelve.title': 'â€œLes enfants ont adorÃ© la sortie nocturne sur la lagune.â€',
      'reviews.featured.twelve.copy':
        'â€œBioluminescence, histoires et chocolat chaud sur le pont : chaque dÃ©tail Ã©tait bien pensÃ©. MÃªme notre ado a laissÃ© son cell pour regarder les Ã©toiles.â€ - <strong>Ruth &amp; family</strong>',
      'reviews.featured.thirteen.title': 'â€œJournÃ©e gourmande du marchÃ© au mezcal.â€',
      'reviews.featured.thirteen.copy':
        'â€œOn a commencÃ© au marchÃ© local pour les Ã©pices, pris un cours de cuisine et terminÃ© par une dÃ©gustation de mezcal avec un maÃ®tre. Câ€™Ã©tait authentique, jamais touristique.â€ - <strong>Eduardo</strong>',
      'reviews.share.heading': 'Partagez votre expÃ©rience',
      'reviews.share.copy':
        'Ã‰crivez-nous Ã  <a href="mailto:info@quebecmexique.com">info@quebecmexique.com</a> avec vos meilleurs moments ou identifiez-nous avec <strong>#QuebecMexique</strong> pour avoir la chance dâ€™apparaÃ®tre.'
    },
    story: {
      'page.title': 'Notre histoire | QuÃ©bec Mexique',
      'story.hero.eyebrow': 'Notre histoire',
      'story.hero.heading': 'NÃ©s de lâ€™amour de la mer et des rÃ©cits',
      'story.hero.copy':
        'Nous croyons que chaque voyageur mÃ©rite un rÃ©cit sur mesure, crÃ©Ã© par notre Ã©quipe, soutenu par la technologie et rempli dâ€™hospitalitÃ© authentique.',
      'story.intro.heading': 'QuÃ©bec Mexique',
      'story.intro.p1':
        'Notre entreprise est nÃ©e dâ€™un constat simple : les expÃ©riences de voyage Ã©taient devenues prÃ©cipitÃ©es, impersonnelles et dÃ©connectÃ©es.',
      'story.intro.p2': 'On savait quâ€™il devait y avoir une meilleure faÃ§on.',
      'story.intro.p3':
        'Au lieu des autobus bondÃ©s, des prises en charge partagÃ©es qui grugent vos vacances et des visites scÃ©narisÃ©es, on a choisi une autre voie : le temps, le confort et la connexion humaine.',
      'story.intro.p4':
        'Chaque expÃ©rience est pensÃ©e pour vous. Aucun transport partagÃ©. Aucun long dÃ©tour. Aucun compromis. Des transferts privÃ©s aux guides locaux soigneusement choisis, tout est conÃ§u pour une journÃ©e fluide, mÃ©morable et significative.',
      'story.intro.p5':
        'Nos guides ne sont pas de simples employÃ©s : ce sont des pros passionnÃ©s, bien rÃ©munÃ©rÃ©s, respectÃ©s et fiers de leur travail. Cette fiertÃ© se ressent dans lâ€™Ã©nergie, le soin et lâ€™authenticitÃ© de chaque sortie.',
      'story.intro.p6':
        'Nous croyons que les meilleurs moments arrivent quand les gens se sentent dÃ©tendus, Ã©coutÃ©s et vraiment connectÃ©s. Cette conviction guide tout ce que nous faisons.',
      'story.intro.p7':
        'Si une expÃ©rience ne rÃ©pond pas Ã  vos attentes, on la corrige. Parce que la confiance, lâ€™intÃ©gritÃ© et la connexion humaine comptent plus que le volume.',
      'story.intro.p8': 'Ce nâ€™est pas du tourisme de masse. Câ€™est voyager avec intention.',
      'story.values.connection.title': 'Connexions authentiques',
      'story.values.connection.copy':
        'Nous concevons chaque expÃ©rience autour dâ€™une vraie connexion humaine pour que nos invitÃ©s se sentent accueillis et compris.',
      'story.values.wages.title': 'Guides bien rÃ©munÃ©rÃ©s',
      'story.values.wages.copy':
        'Nos guides reÃ§oivent des revenus stables et justes, avec respect et stabilitÃ©, pour se consacrer entiÃ¨rement Ã  lâ€™hospitalitÃ©.',
      'story.values.awareness.title': 'Conscience sociale',
      'story.values.awareness.copy':
        'Nous agissons avec empathie et sensibilitÃ© culturelle, en collaborant avec les communautÃ©s locales pour que le tourisme bÃ©nÃ©ficie Ã  tous.',
      'story.crew.heading': 'Rencontrez lâ€™Ã©quipe',
      'story.crew.lila.title': 'Lila Reyes - Fondatrice',
      'story.crew.lila.copy':
        'Biologiste marine devenue conceptrice de voyages, Lila a crÃ©Ã© QuÃ©bec Mexique pour partager des rÃ©cifs cachÃ©s et des communautÃ©s insulaires avec des explorateurs respectueux.',
      'story.crew.makai.title': 'Makai Thompson - Architecte dâ€™expÃ©riences',
      'story.crew.makai.copy':
        'Ã‰levÃ© entre trois Ã®les, Makai tisse rituels culturels, artisans locaux et saveurs uniques dans chaque itinÃ©raire.',
      'story.crew.sami.title': 'Sami Chen - Responsable technologie',
      'story.crew.sami.copy':
        'Sami a dÃ©veloppÃ© notre plateforme collaborative avec disponibilitÃ©s en direct et messages concierge qui ressemblent Ã  un texto.',
      'story.values.heading': 'Nos valeurs',
      'story.values.regen.title': 'Voyages rÃ©gÃ©nÃ©ratifs',
      'story.values.regen.copy':
        'Nous nous associons Ã  des projets communautaires de conservation et consacrons une partie de chaque itinÃ©raire Ã  la restauration des rÃ©cifs.',
      'story.values.hospitality.title': 'HospitalitÃ© avec cÅ“ur',
      'story.values.hospitality.copy':
        'Vos hÃ´tes vous accueillent comme de la famille, avec des surprises et de petites attentions tout au long du parcours.',
      'story.values.tech.title': 'Technologie qui sâ€™efface',
      'story.values.tech.copy':
        'Nos outils de planification sont puissants, mais simples, pour que vous pensiez Ã  lâ€™Ã©motion plutÃ´t quâ€™Ã  la logistique.'
    },
    'tour-detail': {
      'page.title': 'QuÃ©bec Mexique | DÃ©tails de lâ€™excursion',
      'tour.hero.aria': 'AperÃ§u de lâ€™excursion',
      'tour.hero.eyebrow': 'Aventures favorites des voyageurs',
      'tour.gallery.previous': 'Photo prÃ©cÃ©dente',
      'tour.gallery.next': 'Photo suivante',
      'tour.details.heading': 'Planifiez chaque dÃ©tail en toute confiance',
      'tour.details.copy': 'Tout ce quâ€™il faut savoir avant de rÃ©server.',
      'tour.details.about': 'Ã€ propos de cette expÃ©rience',
      'tour.details.includes': 'Ce qui est inclus',
      'tour.booking.label': 'RÃ©server maintenant',
      'tour.booking.from': 'Ã€ partir de',
      'tour.booking.currency': 'USD',
      'tour.booking.perPerson': 'par personne',
      'tour.booking.helper': 'Les prix baissent lorsque vous ajoutez plus de personnes.',
      'tour.booking.guestsLabel': 'Combien de personnes?',
      'tour.booking.nameLabel': 'Nom',
      'tour.booking.namePlaceholder': 'Votre nom complet',
      'tour.booking.emailLabel': 'Courriel',
      'tour.booking.emailPlaceholder': 'vous@exemple.com',
      'tour.booking.phoneLabel': 'NumÃ©ro de tÃ©lÃ©phone',
      'tour.booking.phonePlaceholder': '+52 984 167 0697',
      'tour.booking.datetimeLabel': 'Date et heure de lâ€™activitÃ©',
      'tour.booking.datetimeUnknown': 'Je ne sais pas encore',
      'tour.booking.pickupLabel': 'Lieu de prise en charge',
      'tour.booking.pickupPlaceholder': 'HÃ´tel ou point de rencontre',
      'tour.booking.submit': 'RÃ©server maintenant',
      'tour.booking.note':
        'Aucun paiement nâ€™est perÃ§u ici : nous confirmons la disponibilitÃ© et vous rÃ©pondons rapidement.',
      'tour.booking.disclaimer': 'Les prix et promotions peuvent changer sans prÃ©avis.',
      'tour.booking.status.hold':
        'Nous bloquons {{guests}} place(s) pour {{tour}}. Nous confirmerons la prise en charge Ã  {{pickup}} sans dÃ©lai.',
      'tour.booking.status.missingService':
        'Veuillez connecter le formulaire de rÃ©servation Ã  votre service de courriel pour recevoir les demandes.',
      'tour.booking.status.sent': 'Demande envoyÃ©e! Nous confirmerons la disponibilitÃ© et vous rÃ©pondons rapidement.',
      'tour.booking.status.error': 'Une erreur est survenue lors de lâ€™envoi. Veuillez rÃ©essayer dans quelques minutes.',
      'tour.booking.status.unavailable':
        'Impossible dâ€™envoyer votre demande pour le moment. Veuillez rÃ©essayer plus tard.',
      'tour.booking.pickupFallback': 'votre lieu',
      'tour.booking.datetimeFallback': 'Non fourni',
      'tour.related.aria': 'Autres aventures',
      'tour.related.heading': 'Continuez Ã  explorer',
      'tour.related.copy': 'Dâ€™autres voyageurs ont aussi adorÃ© ces excursions.',
      'tour.related.previous': 'Excursions prÃ©cÃ©dentes',
      'tour.related.next': 'Excursions suivantes'
    }
  }
};

const SUPPORTED_LANGUAGES = ['fr'];
const DEFAULT_LANGUAGE = 'fr';

function getTourContent(tour, lang = DEFAULT_LANGUAGE) {
  const translation = tour.translations?.[lang] || {};
  return {
    name: translation.name || tour.name,
    duration: translation.duration || tour.duration,
    tagline: translation.tagline || tour.tagline,
    description: translation.description || tour.description,
    includes: translation.includes || tour.includes,
    badge: translation.badge || tour.badge
  };
}

const adventureTours = [
  {
    slug: 'promo-mercredi',
    name: 'Promo mercredi : Tortues + Cenote',
    duration: 'Demi-journÃ©e â€¢ Promo mercredi',
    tagline: 'Â· Tortues marines<br>Â· Cenote cristallin<br>Â· Collation fraÃ®che',
    description:
      'Profitez de notre offre spÃ©ciale du mercredi pour nager avec les tortues puis vous rafraÃ®chir dans un cenote lumineux. Câ€™est le combo parfait pour une matinÃ©e douce, simple et pleine de magie bleue. Places limitÃ©es chaque mercredi.',
    includes: [
      'ğŸ¢ Snorkel avec les tortues',
      'ğŸŒŠ 2 cenotes',
      'ğŸ§— 1 rappel (optionnel, sans frais supplÃ©mentaires)',
      'ğŸ¥ª Snack box et eau'
    ],
    image:
      'https://images.pexels.com/photos/847393/pexels-photo-847393.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: [
      'assets/TurtlePromo/AkumalPromo01.mov'
    ],
    prices: {
      1: 89,
      2: 89,
      3: 89,
      4: 89,
      5: 89,
      6: 89,
      7: 89,
      8: 89,
      9: 89,
      10: 89,
      11: 89,
      12: 89
    },
    badge: 'Promo mercredi'
  },
  {
    slug: 'tulum-turtles-cenotes',
    name: 'Tulum sous lâ€™eau',
    duration: 'JournÃ©e complÃ¨te â€¢ Culture + eau',
    tagline: 'Â· Ruines de Tulum<br>Â· Snorkel avec tortues<br>Â· 2 cenotes<br>Â· DÃ®ner local complet',
    description:
      'Parcourez les falaises de Tulum avec un guide chaleureux, puis plongez pour faire du snorkel avec les tortues avant de vous rafraÃ®chir dans deux superbes cenotes. La journÃ©e se dÃ©roule en douceur avec des arrÃªts photo, un rythme facile et un dÃ®ner local complet aux saveurs du YucatÃ¡n. Une excursion Ã  la fois magique et simple.',
    includes: ['ğŸ›ï¸ Visite des ruines de Tulum', 'ğŸ¢ Snorkel avec les tortues', 'ğŸŒŠ Nage dans 2 cenotes', 'ğŸŒ® DÃ®ner local complet'],
    image:
      'https://images.pexels.com/photos/5992273/pexels-photo-5992273.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: [
      'https://images.pexels.com/photos/5992273/pexels-photo-5992273.jpeg?auto=format&fit=crop&w=1200&q=70',
      'https://images.pexels.com/photos/5992273/pexels-photo-5992273.jpeg?auto=format&fit=crop&w=1200&q=70&sat=-6'
    ],
    prices: {
      1: 390,
      2: 268,
      3: 257,
      4: 234,
      5: 212,
      6: 201,
      7: 190,
      8: 179,
      9: 174,
      10: 169,
      11: 169,
      12: 169
    },
    badge: 'Meilleure vente'
  },
  {
    slug: 'cenotes-express',
    name: 'Cenotes Express',
    duration: 'Demi-journÃ©e â€¢ Circuit de cenotes',
    tagline: 'Â· 4 cenotes<br>Â· Descente en rappel dans une caverne<br>Â· Collation et biÃ¨res',
    description:
      'Plongez dans quatre cenotes diffÃ©rents, chacun plus beau que le prÃ©cÃ©dent, puis descendez en rappel dans une caverne pour un vrai moment wow. Entre les baignades, vous aurez le temps de reprendre des forces avec une collation et une boisson froide. Une aventure compacte remplie de moments aquatiques.',
    includes: ['ğŸŒŠ Visite de 4 cenotes', 'ğŸ§— Descente en rappel dans une caverne', 'ğŸº Collation et biÃ¨res'],
    image:
      'https://images.pexels.com/photos/2410870/pexels-photo-2410870.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/2410870/pexels-photo-2410870.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 295,
      2: 173,
      3: 162,
      4: 140,
      5: 118,
      6: 107,
      7: 95,
      8: 84,
      9: 79,
      10: 74,
      11: 74,
      12: 74
    },
    badge: 'Nouvel itinÃ©raire'
  },
  {
    slug: 'turtles-cenotes',
    name: 'Tortues + Cenotes',
    duration: 'Demi-journÃ©e â€¢ OcÃ©an + jungle',
    tagline: 'Â· Tortues marines<br>Â· 3 cenotes<br>Â· Collation et boissons',
    description:
      'Passez une matinÃ©e de rÃªve dans lâ€™eau, en commenÃ§ant par un snorkel doux avec les tortues de mer et en terminant dans trois cenotes cristallins cachÃ©s dans la jungle. Chaque arrÃªt ressemble Ã  une carte postale, avec du temps pour flotter, respirer et profiter. Une aventure simple et mÃ©morable qui reste grandiose et inoubliable.',
    includes: ['ğŸ¢ Nager avec les tortues marines', 'ğŸ¤¿ Snorkel dans 3 cenotes', 'ğŸ¥¤ Collation et boissons'],
    image:
      'https://images.pexels.com/photos/847393/pexels-photo-847393.jpeg?_gl=1*1leu1xd*_ga*NTc3NjYyMTQzLjE3NjU4MTE2NzU.*_ga_8JE65Q40S6*czE3NjU5MDM2NjEkbzMkZzEkdDE3NjU5MDM2ODckajM0JGwwJGgw',
    gallery: [
      'https://images.pexels.com/photos/847393/pexels-photo-847393.jpeg?_gl=1*1leu1xd*_ga*NTc3NjYyMTQzLjE3NjU4MTE2NzU.*_ga_8JE65Q40S6*czE3NjU5MDM2NjEkbzMkZzEkdDE3NjU5MDM2ODckajM0JGwwJGgw',
      'https://images.pexels.com/photos/32865198/pexels-photo-32865198.jpeg?auto=format&fit=crop&w=1200&q=70',
      'https://images.pexels.com/photos/32865198/pexels-photo-32865198.jpeg?auto=format&fit=crop&w=1200&q=70&sat=-8'
    ],
    prices: {
      1: 340,
      2: 218,
      3: 207,
      4: 184,
      5: 162,
      6: 151,
      7: 140,
      8: 129,
      9: 124,
      10: 119,
      11: 119,
      12: 119
    },
    badge: 'Coup de cÅ“ur'
  },
  {
    slug: 'tulum-express',
    name: 'Tulum Express',
    duration: 'Demi-journÃ©e â€¢ Touche culturelle',
    tagline: 'Â· Ruines de Tulum<br>Â· Boissons et biÃ¨res<br>Â· (Optionnel) Temps libre Ã  Tulum',
    description:
      'Explorez les ruines de Tulum avec un guide certifiÃ© qui rend lâ€™histoire claire et agrÃ©able. Vous aurez le temps pour les vues iconiques, de belles photos et une marche relax. AprÃ¨s la visite, profitez dâ€™un temps libre optionnel pour magasiner, prendre un cafÃ© ou une collation.',
    includes: ['ğŸ›ï¸ EntrÃ©e des ruines de Tulum', 'ğŸ¹ Boissons et biÃ¨res', 'ğŸ›ï¸ Temps libre optionnel Ã  Tulum'],
    image:
      'https://images.pexels.com/photos/13713189/pexels-photo-13713189.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/13713189/pexels-photo-13713189.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 290,
      2: 168,
      3: 157,
      4: 135,
      5: 113,
      6: 102,
      7: 90,
      8: 79,
      9: 74,
      10: 69,
      11: 69,
      12: 69
    },
    badge: 'Escapade rapide'
  },
  {
    slug: 'tacos-tour',
    name: 'TournÃ©e tacos',
    duration: 'SoirÃ©e â€¢ Parcours gourmand',
    tagline: 'Â· Tacos authentiques<br>Â· BiÃ¨res, tequila et mezcal<br>Â· Temps libre Ã  Playa del Carmen',
    description:
      'GoÃ»tez des tacos authentiques dans des adresses locales, dÃ©gustez tequila ou mezcal et profitez dâ€™une soirÃ©e animÃ©e Ã  Playa del Carmen sans se presser. Chaque arrÃªt est simple, savoureux et plein de charme local. Une soirÃ©e dÃ©licieuse qui ressemble Ã  une cÃ©lÃ©bration.',
    includes: ['ğŸŒ® Tacos authentiques', 'ğŸ¥ƒ BiÃ¨res, tequila et mezcal', 'ğŸŒ† Temps libre Ã  Playa del Carmen'],
    image:
      'https://images.pexels.com/photos/4958641/pexels-photo-4958641.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/4958641/pexels-photo-4958641.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 280,
      2: 158,
      3: 147,
      4: 125,
      5: 103,
      6: 92,
      7: 80,
      8: 69,
      9: 64,
      10: 59,
      11: 59,
      12: 59
    },
    badge: 'Favori gourmand'
  },
  {
    slug: 'tulum-coba',
    name: 'Tulum + CobÃ¡',
    duration: 'JournÃ©e complÃ¨te â€¢ Ruines + cenote',
    tagline: 'Â· Ruines de Tulum<br>Â· Ruines de CobÃ¡<br>Â· Cenote avec tyrolienne<br>Â· Buffet local et boissons',
    description:
      'Passez une journÃ©e complÃ¨te Ã  visiter les ruines de Tulum et de CobÃ¡ avec des guides qui expliquent tout simplement et clairement. RafraÃ®chissez-vous dans un cenote avec tyrolienne, puis terminez avec un buffet local et des boissons. Une excursion complÃ¨te qui reste fluide.',
    includes: ['ğŸ›ï¸ Ruines de Tulum', 'ğŸŒ¿ Ruines de CobÃ¡', 'ğŸª‚ Cenote avec tyrolienne', 'ğŸ¥˜ Buffet local et boissons'],
    image:
      'https://images.pexels.com/photos/17179205/pexels-photo-17179205.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/17179205/pexels-photo-17179205.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 534,
      2: 300,
      3: 267,
      4: 256,
      5: 234,
      6: 212,
      7: 200,
      8: 189,
      9: 184,
      10: 179,
      11: 179,
      12: 179
    },
    badge: 'Aventure dâ€™une journÃ©e'
  },
  {
    slug: 'coba',
    name: 'CobÃ¡',
    duration: 'JournÃ©e complÃ¨te â€¢ Histoire dans la jungle',
    tagline: 'Â· Ruines de CobÃ¡<br>Â· Tour Ã  vÃ©lo sur le site<br>Â· Cenote avec tyrolienne<br>Â· Buffet rÃ©gional et boissons',
    description:
      'Parcourez Ã  vÃ©lo les ruines de CobÃ¡ dans la jungle avec un guide qui fait revivre lâ€™histoire de faÃ§on simple et captivante. Ensuite, rafraÃ®chissez-vous dans un cenote avec tyrolienne et profitez dâ€™un buffet rÃ©gional avec boissons. Une grande journÃ©e qui reste relax.',
    includes: ['ğŸŒ¿ Ruines de CobÃ¡', 'ğŸš² Tour Ã  vÃ©lo sur le site', 'ğŸª‚ Cenote avec tyrolienne', 'ğŸ¥˜ Buffet rÃ©gional et boissons'],
    image:
      'https://images.pexels.com/photos/14902028/pexels-photo-14902028.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/14902028/pexels-photo-14902028.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 367,
      2: 234,
      3: 228,
      4: 189,
      5: 167,
      6: 156,
      7: 164,
      8: 134,
      9: 129,
      10: 124,
      11: 124,
      12: 124
    },
    badge: 'Histoire vivante'
  },
  {
    slug: 'chichen-itza',
    name: 'ChichÃ©n ItzÃ¡',
    duration: 'JournÃ©e complÃ¨te â€¢ Merveille du monde',
    tagline: 'Â· Ruines de ChichÃ©n ItzÃ¡<br>Â· Cenote avec tyrolienne<br>Â· Buffet local avec boissons',
    description:
      'DÃ©couvrez ChichÃ©n ItzÃ¡ avec un guide passionnÃ© qui partage les histoires des temples de faÃ§on claire et mÃ©morable. Puis nagez dans un cenote avec tyrolienne avant un buffet rÃ©gional avec boissons. Une excursion de classe mondiale, fluide et exaltante.',
    includes: ['ğŸ—¿ Ruines de ChichÃ©n ItzÃ¡', 'ğŸª‚ Cenote avec tyrolienne', 'ğŸ¥˜ Buffet local avec boissons'],
    image:
      'https://images.pexels.com/photos/3290068/pexels-photo-3290068.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/3290068/pexels-photo-3290068.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      2: 317,
      3: 317,
      4: 272,
      5: 239,
      6: 217,
      7: 205,
      8: 194,
      9: 189,
      10: 184,
      11: 184,
      12: 184
    },
    badge: 'Site UNESCO'
  },
  {
    slug: 'coba-chichen-itza',
    name: 'CobÃ¡ + ChichÃ©n ItzÃ¡',
    duration: 'JournÃ©e complÃ¨te â€¢ Deux merveilles',
    tagline: 'Â· Ruines de CobÃ¡<br>Â· Ruines de ChichÃ©n ItzÃ¡<br>Â· Cenote avec tyrolienne<br>Â· Buffet local avec boissons',
    description:
      'Visitez CobÃ¡ au cÅ“ur de la jungle et ChichÃ©n ItzÃ¡ sur la plaine en une seule journÃ©e bien rythmÃ©e. Coupez lâ€™aventure avec une tyrolienne en cenote et un buffet rÃ©gional avec boissons. Une excursion unique, facile et amusante.',
    includes: ['ğŸŒ¿ Ruines de CobÃ¡', 'ğŸ—¿ Ruines de ChichÃ©n ItzÃ¡', 'ğŸª‚ Cenote avec tyrolienne', 'ğŸ¥˜ Buffet local avec boissons'],
    image:
      'https://images.pexels.com/photos/31657162/pexels-photo-31657162.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/31657162/pexels-photo-31657162.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      2: 352,
      3: 352,
      4: 307,
      5: 274,
      6: 252,
      7: 240,
      8: 229,
      9: 224,
      10: 219,
      11: 219,
      12: 219
    },
    badge: 'Circuit Ã©pique'
  },
  {
    slug: 'holbox-express',
    name: 'Holbox Express',
    duration: 'JournÃ©e complÃ¨te â€¢ Saut dâ€™Ã®les',
    tagline:
      'Â· Bateau rapide privÃ©<br>Â· Saut entre 3 Ã®les<br>Â· Car de golf<br>Â· Temps libre sur lâ€™Ã®le<br>Â· Buffet de beach club avec bar ouvert',
    description:
      'Montez Ã  bord dâ€™un bateau rapide privÃ© pour sauter entre les Ã®les de Holbox, relaxer sur des bancs de sable blancs et explorer Ã  votre rythme. Lâ€™eau est superbe, lâ€™ambiance dÃ©contractÃ©e et la journÃ©e ressemble Ã  un film tropical. Un buffet de beach club avec bar ouvert garde le tout festif et simple.',
    includes: ['ğŸš¤ Bateau rapide privÃ©', 'ğŸï¸ Saut entre 3 Ã®les', 'ğŸ›º Car de golf', 'ğŸ–ï¸ Temps libre sur lâ€™Ã®le', 'ğŸ¹ Buffet de beach club avec bar ouvert'],
    image:
      'https://images.pexels.com/photos/11481626/pexels-photo-11481626.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/11481626/pexels-photo-11481626.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 740,
      2: 384,
      3: 329,
      4: 273,
      5: 229,
      6: 195,
      7: 173,
      8: 151,
      9: 146,
      10: 141,
      11: 141,
      12: 141
    },
    badge: 'Vie insulaire'
  },
  {
    slug: 'dolphin-turtle',
    name: 'Dauphins + Tortues',
    duration: 'JournÃ©e complÃ¨te â€¢ RÃ©serve UNESCO',
    tagline:
      'Â· Sian Kaâ€™an en bateau rapide<br>Â· Dauphins + tortues<br>Â· Observation dâ€™oiseaux<br>Â· Snorkel sur rÃ©cif<br>Â· Buffet local',
    description:
      'Parcourez la rÃ©serve de Sian Kaâ€™an en bateau rapide pour chercher dauphins, tortues et vie rÃ©cifale dans un paradis protÃ©gÃ©. Ralentissez pour lâ€™observation dâ€™oiseaux, puis faites du snorkel avant de terminer par un buffet en bord de mer. Une excursion Ã©poustouflante qui mÃ©lange faune, eau et dÃ©tente.',
    includes: ['ğŸš¤ Sian Kaâ€™an en bateau rapide', 'ğŸ¬ Dauphins et tortues', 'ğŸ¦œ Observation dâ€™oiseaux', 'ğŸ¤¿ Snorkel sur rÃ©cif', 'ğŸ½ï¸ Buffet local'],
    image:
      'https://images.pexels.com/photos/2922672/pexels-photo-2922672.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/2922672/pexels-photo-2922672.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 707,
      2: 376,
      3: 254,
      4: 210,
      5: 176,
      6: 198,
      7: 176,
      8: 165,
      9: 160,
      10: 155,
      11: 155,
      12: 155
    },
    badge: 'RÃ©serve UNESCO'
  },
  {
    slug: 'fishing-half-day',
    name: 'PÃªche demi-journÃ©e',
    duration: 'Demi-journÃ©e â€¢ Bateau privÃ©',
    tagline: 'Â· Bateau privÃ©<br>Â· Ã‰quipement de pÃªche<br>Â· Ceviche et poisson frais<br>Â· Boissons et biÃ¨res',
    description:
      'Profitez dâ€™une sortie de pÃªche privÃ©e avec des guides pros, des eaux calmes et un rythme facile le long de la cÃ´te. Ramenez votre prise, puis savourez ceviche frais, poisson et boissons froides Ã  bord. Une faÃ§on simple et incroyable de passer une demi-journÃ©e dans les CaraÃ¯bes.',
    includes: ['ğŸ›¥ï¸ Bateau privÃ©', 'ğŸ£ Ã‰quipement de pÃªche', 'ğŸŸ Ceviche frais et poisson', 'ğŸº Boissons et biÃ¨res'],
    image:
      'https://images.pexels.com/photos/3793366/pexels-photo-3793366.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: [
      'https://images.pexels.com/photos/3793366/pexels-photo-3793366.jpeg?auto=format&fit=crop&w=1200&q=70',
      'https://images.pexels.com/photos/3793366/pexels-photo-3793366.jpeg?auto=format&fit=crop&w=1200&q=70&sat=-10'
    ],
    prices: {
      1: 0,
      2: 0,
      3: 0,
      4: 0,
      5: 0,
      6: 0,
      7: 0,
      8: 0,
      9: 0,
      10: 0,
      11: 0,
      12: 0
    },
    badge: 'Bateau privÃ©'
  }
];


const currencyFormatter = new Intl.NumberFormat('en-US', {
  style: 'currency',
  currency: 'USD',
  maximumFractionDigits: 0
});

function interpolate(template, replacements = {}) {
  return template.replace(/\{\{(\w+)\}\}/g, (_, key) =>
    Object.prototype.hasOwnProperty.call(replacements, key) ? String(replacements[key]) : ''
  );
}

function createLanguageManager(pageKey) {
  const LANGUAGE_STORAGE_KEY = 'preferred-language';
  const storedLanguage = localStorage.getItem(LANGUAGE_STORAGE_KEY);
  const documentLanguage = document.documentElement.lang;
  let currentLanguage = SUPPORTED_LANGUAGES.includes(storedLanguage || '')
    ? storedLanguage
    : SUPPORTED_LANGUAGES.includes(documentLanguage)
    ? documentLanguage
    : DEFAULT_LANGUAGE;
  const listeners = new Set();

  function getTranslationValue(lang, key) {
    const languageSet = translations[lang];
    if (!languageSet) return null;

    if (languageSet.global && Object.prototype.hasOwnProperty.call(languageSet.global, key)) {
      return languageSet.global[key];
    }

    if (pageKey && languageSet[pageKey] && Object.prototype.hasOwnProperty.call(languageSet[pageKey], key)) {
      return languageSet[pageKey][key];
    }

    return null;
  }

  function translateDocument(lang) {
    const languageSet = translations[lang];
    if (!languageSet) return;

    document.documentElement.lang = lang;

    const groups = [];
    if (languageSet.global) {
      groups.push(languageSet.global);
    }
    if (pageKey && languageSet[pageKey]) {
      groups.push(languageSet[pageKey]);
    }

    groups.forEach((group) => {
      Object.entries(group).forEach(([key, value]) => {
        const elements = document.querySelectorAll(`[data-i18n="${key}"]`);
        if (!elements.length) return;

        elements.forEach((element) => {
          const attr = element.dataset.i18nAttr;
          if (attr === 'html') {
            element.innerHTML = value;
          } else if (attr) {
            element.setAttribute(attr, value);
          } else {
            element.textContent = value;
          }
        });
      });
    });
  }

  function notify(lang) {
    listeners.forEach((callback) => {
      try {
        callback(lang);
      } catch (error) {
        console.error(error);
      }
    });
  }

  function applyLanguage(lang) {
    translateDocument(lang);
    notify(lang);
  }

  return {
    init() {
      applyLanguage(currentLanguage);
    },
    getLanguage() {
      return currentLanguage;
    },
    setLanguage(lang) {
      if (!SUPPORTED_LANGUAGES.includes(lang) || lang === currentLanguage) {
        return;
      }

      currentLanguage = lang;
      localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
      applyLanguage(lang);
    },
    onChange(callback) {
      if (typeof callback !== 'function') {
        return () => {};
      }

      listeners.add(callback);
      callback(currentLanguage);
      return () => listeners.delete(callback);
    },
    translate(key, replacements = {}, lang = currentLanguage) {
      const template = getTranslationValue(lang, key);
      if (typeof template !== 'string') {
        return '';
      }

      return interpolate(template, replacements);
    }
  };
}

(function () {
  document.addEventListener('DOMContentLoaded', () => {
    const pageKey = document.body?.dataset.page || 'home';
    const languageManager = createLanguageManager(pageKey);
    const isToursPage = pageKey === 'tours';

    setupNavigation();
    setupLanguageToggle(languageManager);
    window.addEventListener('resize', scheduleNavControlWidthSync, { passive: true });

    const refreshTourLists = () => {
      const catalogTours = isToursPage
        ? adventureTours.filter((tour) => tour.slug !== 'promo-mercredi')
        : adventureTours;
      if (isToursPage) {
        buildToursHeroSlider(catalogTours, languageManager);
        buildToursCatalog(catalogTours, languageManager);
      }
      buildFavoritesCarousel(adventureTours, languageManager);
      setupCardCarousels();
      setupMediaPrefetch();
    };

    refreshTourLists();
    setupHeroSlider(languageManager);
    initTourPage(adventureTours, languageManager);
    setupMediaPrefetch();
    setupInquiryForm(languageManager);
    setCurrentYear();

    languageManager.init();
    languageManager.onChange(refreshTourLists);
    scheduleNavControlWidthSync();
  });
})();

function setupNavigation() {
  const navToggle = document.querySelector('[data-nav-toggle]');
  const navLinks = document.querySelector('.nav__links');

  if (!navToggle || !navLinks) return;

  navToggle.addEventListener('click', () => {
    const isOpen = navLinks.classList.toggle('open');
    navToggle.setAttribute('aria-expanded', String(isOpen));
  });

  navLinks.querySelectorAll('a').forEach((link) => {
    link.addEventListener('click', () => {
      if (navLinks.classList.contains('open')) {
        navLinks.classList.remove('open');
        navToggle.setAttribute('aria-expanded', 'false');
      }
    });
  });
}

let navControlWidthSyncScheduled = false;

function syncNavControlWidths() {
  navControlWidthSyncScheduled = false;
  const controls = Array.from(document.querySelectorAll('.language-toggle'));
  if (controls.length < 2) {
    return;
  }

  controls.forEach((control) => {
    control.style.removeProperty('--nav-control-width');
  });

  const maxWidth = controls.reduce((largest, control) => {
    const { width } = control.getBoundingClientRect();
    return width > largest ? width : largest;
  }, 0);

  if (!maxWidth) {
    return;
  }

  const widthValue = `${Math.ceil(maxWidth)}px`;
  controls.forEach((control) => {
    control.style.setProperty('--nav-control-width', widthValue);
  });
}

function scheduleNavControlWidthSync() {
  if (navControlWidthSyncScheduled) {
    return;
  }

  navControlWidthSyncScheduled = true;
  const scheduler =
    typeof window.requestAnimationFrame === 'function'
      ? window.requestAnimationFrame.bind(window)
      : (callback) => window.setTimeout(callback, 16);

  scheduler(() => {
    syncNavControlWidths();
  });
}

function setupLanguageToggle(languageManager) {
  const toggle = document.querySelector('[data-language-toggle]');
  if (!toggle) return;

  toggle.textContent = 'FranÃ§ais';
  toggle.setAttribute('aria-pressed', 'true');
  scheduleNavControlWidthSync();
}

function setupHeroSlider(languageManager) {
  const slider = document.querySelector('.hero-slider');
  if (!slider) return;

  const slides = Array.from(slider.querySelectorAll('.hero-slide'));
  const dotsContainer = slider.querySelector('.hero-slider__dots');
  const prevButton = slider.querySelector('[data-slide="prev"]');
  const nextButton = slider.querySelector('[data-slide="next"]');

  if (!slides.length) return;

  let currentIndex = slides.findIndex((slide) => slide.classList.contains('is-active'));
  if (currentIndex === -1) {
    slides[0].classList.add('is-active');
    currentIndex = 0;
  }

  const HAVE_CURRENT_DATA =
    typeof HTMLMediaElement !== 'undefined' ? HTMLMediaElement.HAVE_CURRENT_DATA : 2;
  let autoRotateTimer = null;
  const DEFAULT_ROTATE_INTERVAL = 7000;
  const hasMultipleSlides = slides.length > 1;

  const ensureMediaSource = (slide, index, eager = false) => {
    const media = slide.querySelector('.hero-slide__media');
    if (!media) return null;

    if (!media.src && media.dataset?.src && (eager || slide.classList.contains('is-active'))) {
      media.src = media.dataset.src;
    }

    if (media.tagName.toLowerCase() === 'video') {
      media.preload = eager ? 'auto' : 'metadata';
    }

    return media;
  };

  const handleMediaEnded = (index) => {
    if (!hasMultipleSlides) return;
    if (currentIndex !== index) return;
    nextSlide();
  };

  slides.forEach((slide, index) => {
    const media = ensureMediaSource(slide, index, index === currentIndex);
    if (!media) return;
    const isVideo = media.tagName.toLowerCase() === 'video';
    const endOffsetSeconds = Number(media.dataset?.endOffset ?? media.dataset?.endOffsetSeconds ?? 0);

    const markLoaded = () => {
      media.classList.add('is-loaded');
    };

    if (isVideo) {
      media.muted = true;
      media.setAttribute('muted', '');
      media.playsInline = true;
      media.setAttribute('playsinline', '');
      media.loop = false;
      media.preload = index === currentIndex ? 'auto' : 'metadata';

      if (media.readyState >= HAVE_CURRENT_DATA) {
        markLoaded();
      } else {
        ['loadeddata', 'canplay'].forEach((eventName) => {
          media.addEventListener(eventName, markLoaded, { once: true });
        });
      }

      media.addEventListener('loadedmetadata', () => {
        if (index === currentIndex) {
          scheduleAutoRotate();
        }
      });

      if (Number.isFinite(endOffsetSeconds) && endOffsetSeconds > 0) {
        const handleEarlyEnd = () => {
          const { duration, currentTime } = media;
          if (!Number.isFinite(duration)) return;

          const effectiveEnd = Math.max(0, duration - endOffsetSeconds);
          if (currentTime >= effectiveEnd) {
            media.pause();
            media.removeEventListener('timeupdate', handleEarlyEnd);
            handleMediaEnded(index);
          }
        };

        media.addEventListener('timeupdate', handleEarlyEnd);
      }

      media.addEventListener(
        'error',
        () => {
          slide.classList.add('hero-slide--unavailable');
        },
        { once: true }
      );

      media.addEventListener('ended', () => handleMediaEnded(index));
    } else {
      const handleError = () => {
        markLoaded();
        slide.classList.add('hero-slide--unavailable');
      };

      if (media.complete) {
        markLoaded();
      } else {
        media.addEventListener('load', markLoaded, { once: true });
        media.addEventListener('error', handleError, { once: true });
      }
    }
  });

  function setSlideState(slide, isActive, index) {
    slide.classList.toggle('is-active', isActive);
    slide.setAttribute('aria-hidden', isActive ? 'false' : 'true');

    const video = ensureMediaSource(slide, index, isActive);
    if (!video) return;

    if (isActive) {
      if (video.tagName.toLowerCase() === 'video') {
        video.muted = true;
        video.setAttribute('muted', '');
        video.playsInline = true;
        video.setAttribute('playsinline', '');
      }
      if (video.preload !== 'auto') {
        video.preload = 'auto';
      }
      if (video.readyState < HAVE_CURRENT_DATA && typeof video.load === 'function') {
        video.load();
      }
      if (typeof video.play === 'function') {
        const playPromise = video.play();
        if (playPromise && typeof playPromise.catch === 'function') {
          playPromise.catch(() => {});
        }
      }
    } else {
      if (video.preload !== 'metadata') {
        video.preload = 'metadata';
      }
      if (typeof video.pause === 'function') {
        video.pause();
      }
      if (!video.loop) {
        try {
          video.currentTime = 0;
        } catch (error) {
          // Some browsers might not allow resetting the currentTime for certain sources.
        }
      }
    }
  }

  function syncSlides() {
    slides.forEach((slide, index) => {
      setSlideState(slide, index === currentIndex, index);
    });
  }

  function goToSlide(index) {
    const nextIndex = (index + slides.length) % slides.length;
    if (nextIndex === currentIndex) return;

    const previousSlide = slides[currentIndex];
    const nextSlide = slides[nextIndex];

    setSlideState(previousSlide, false, currentIndex);
    currentIndex = nextIndex;
    setSlideState(nextSlide, true, currentIndex);
    updateDots();
    restartAutoRotate();
  }

  function nextSlide() {
    goToSlide(currentIndex + 1);
  }

  function previousSlide() {
    goToSlide(currentIndex - 1);
  }

  const scheduleAutoRotate = () => {
    if (!hasMultipleSlides) return;
    stopAutoRotate();

    const activeSlide = slides[currentIndex];
    const activeVideo = ensureMediaSource(activeSlide, currentIndex, true);
    const duration = activeVideo?.duration;
    const delay = Number.isFinite(duration) && duration > 0 ? duration * 1000 : DEFAULT_ROTATE_INTERVAL;

    autoRotateTimer = window.setTimeout(nextSlide, delay);
  };

  function startAutoRotate() {
    scheduleAutoRotate();
  }

  function stopAutoRotate() {
    if (autoRotateTimer) {
      window.clearTimeout(autoRotateTimer);
      autoRotateTimer = null;
    }
  }

  function restartAutoRotate() {
    scheduleAutoRotate();
  }

  function updateDotLabels(lang = languageManager.getLanguage()) {
    if (!dotsContainer) return;
    const dots = dotsContainer.querySelectorAll('.hero-slider__dot');
    dots.forEach((dot, index) => {
      dot.setAttribute('aria-label', languageManager.translate('heroSlider.goToSlide', { index: index + 1 }, lang));
    });
  }

  function buildDots() {
    if (!dotsContainer || !hasMultipleSlides) return;

    dotsContainer.innerHTML = '';
    slides.forEach((_, index) => {
      const dot = document.createElement('button');
      dot.className = 'hero-slider__dot';
      dot.type = 'button';
      dot.setAttribute('role', 'tab');
      dot.setAttribute('aria-label', languageManager.translate('heroSlider.goToSlide', { index: index + 1 }));
      dot.addEventListener('click', () => goToSlide(index));
      dotsContainer.append(dot);
    });

    updateDots();
  }

  function updateDots() {
    if (!dotsContainer || !hasMultipleSlides) return;
    const dots = dotsContainer.querySelectorAll('.hero-slider__dot');
    dots.forEach((dot, index) => {
      dot.setAttribute('aria-selected', index === currentIndex ? 'true' : 'false');
    });
    updateDotLabels();
  }

  syncSlides();

  prevButton?.addEventListener('click', previousSlide);
  nextButton?.addEventListener('click', nextSlide);

  if (hasMultipleSlides) {
    slider.addEventListener('mouseenter', stopAutoRotate);
    slider.addEventListener('mouseleave', startAutoRotate);
    slider.addEventListener('focusin', stopAutoRotate);
    slider.addEventListener('focusout', startAutoRotate);
  }

  buildDots();
  startAutoRotate();

  languageManager.onChange(updateDotLabels);
}

function buildToursHeroSlider(tours, languageManager) {
  const slider = document.querySelector('[data-tour-hero-slider]');
  const track = slider?.querySelector('[data-tour-hero-track]');
  if (!slider || !track || !tours.length) return;

  const lang = languageManager?.getLanguage() || DEFAULT_LANGUAGE;
  const updateSlide = (slide, tour) => {
    const content = getTourContent(tour, lang);
    const title = slide.querySelector('[data-tour-hero-title]');
    const cta = slide.querySelector('[data-tour-hero-cta]');
    const link = slide.querySelector('.hero-slide__link');
    const image = slide.querySelector('img');
    const viewLabel = languageManager?.translate('tour.card.viewAria', { name: content.name }, lang) || content.name;

    if (title) title.textContent = content.name;
    if (cta) cta.textContent = languageManager?.translate('tour.card.bookNow', {}, lang) || 'Book now';
    if (link) link.setAttribute('aria-label', viewLabel);
    if (image) image.alt = viewLabel;
  };

  if (!track.children.length) {
    tours.forEach((tour, index) => {
      const content = getTourContent(tour, lang);
      const slide = document.createElement('article');
      slide.className = `hero-slide${index === 0 ? ' is-active' : ''}`;
      slide.setAttribute('aria-hidden', index === 0 ? 'false' : 'true');
      slide.dataset.tourSlug = tour.slug;
      const viewLabel = languageManager?.translate('tour.card.viewAria', { name: content.name }, lang) || content.name;
      slide.innerHTML = `
        <a class="hero-slide__link" href="tour.html?tour=${tour.slug}" aria-label="${viewLabel}">
          <img class="hero-slide__media" src="${tour.image}" alt="${viewLabel}" loading="lazy" decoding="async" />
          <div class="hero-slide__overlay">
            <h2 data-tour-hero-title>${content.name}</h2>
            <span class="button button--primary hero-slide__cta" data-tour-hero-cta>${languageManager?.translate('tour.card.bookNow', {}, lang) || 'Book now'}</span>
          </div>
        </a>
      `;
      track.appendChild(slide);
    });
  } else {
    Array.from(track.children).forEach((slide) => {
      const slug = slide.dataset.tourSlug;
      const tour = tours.find((item) => item.slug === slug);
      if (tour) {
        updateSlide(slide, tour);
      }
    });
  }
}

function createFavoriteCard(tour, languageManager) {
  const halfDaySlugs = new Set(['tulum-express', 'cenotes-express', 'tacos-tour', 'turtles-cenotes']);
  const lang = languageManager?.getLanguage() || DEFAULT_LANGUAGE;
  const content = getTourContent(tour, lang);
  const durationKey = halfDaySlugs.has(tour.slug) ? 'tour.card.halfDay' : 'tour.card.fullDay';
  const durationLabel = tour.slug === 'promo-mercredi'
    ? 'Tour PartagÃ©'
    : (languageManager?.translate(durationKey, {}, lang) || content.duration);
  const viewLabel = languageManager?.translate('tour.card.viewDetails', {}, lang) || 'View details';
  const ariaLabel = languageManager?.translate('tour.card.viewAria', { name: content.name }, lang) || content.name;
  const tagLabel = content.badge || content.tagline;
  const article = document.createElement('article');
  article.className = `card favorite-card${tour.slug === 'promo-mercredi' ? ' favorite-card--promo' : ''}`;
  article.setAttribute('role', 'listitem');
  article.innerHTML = `
    <a class="favorite-card__media" href="tour.html?tour=${tour.slug}" aria-label="${ariaLabel}">
      <img src="${tour.image}" alt="${content.name}" loading="lazy" decoding="async" />
      <span class="favorite-card__tag">${tagLabel}</span>
      <span class="favorite-card__badge">${durationLabel}</span>
    </a>
    <div class="favorite-card__body">
      <h3>${content.name}</h3>
      <p class="favorite-card__deal">${content.tagline}</p>
      <p class="favorite-card__copy">${content.description}</p>
      <a class="button button--primary favorite-card__cta" href="tour.html?tour=${tour.slug}">${viewLabel}</a>
    </div>
  `;
  return article;
}

function createTourGridCard(tour, languageManager) {
  const lang = languageManager?.getLanguage() || DEFAULT_LANGUAGE;
  const content = getTourContent(tour, lang);
  const badgeLabel = content.badge || languageManager?.translate('tour.card.privateBadge', {}, lang) || 'Private tour';
  const ctaLabel = languageManager?.translate('tour.card.bookNow', {}, lang) || 'Book now';
  const ariaLabel = languageManager?.translate('tour.card.viewAria', { name: content.name }, lang) || content.name;
  const article = document.createElement('article');
  article.className = 'card tour-grid-card';
  article.setAttribute('role', 'listitem');
  article.innerHTML = `
    <div class="tour-grid-card__media">
      <a href="tour.html?tour=${tour.slug}" aria-label="${ariaLabel}">
        <img src="${tour.image}" alt="${content.name}" loading="lazy" decoding="async" />
        <span class="tour-grid-card__badge">${badgeLabel}</span>
      </a>
    </div>
    <div class="tour-grid-card__body">
      <h3 class="tour-grid-card__title">${content.name}</h3>
      <p class="tour-grid-card__meta">${content.duration}</p>
      <p class="tour-grid-card__copy">${content.description}</p>
      <a class="button button--primary tour-grid-card__cta" href="tour.html?tour=${tour.slug}">${ctaLabel}</a>
    </div>
  `;
  return article;
}

function populateCardTrack(selector, tours, languageManager) {
  const track = document.querySelector(selector);
  if (!track) return null;
  track.innerHTML = '';
  tours.forEach((tour) => track.appendChild(createFavoriteCard(tour, languageManager)));
  return track;
}

function buildToursCatalog(tours, languageManager) {
  const grid = document.querySelector('[data-tour-grid]');
  if (!grid || !tours.length) return;

  grid.innerHTML = '';
  tours.forEach((tour) => grid.appendChild(createTourGridCard(tour, languageManager)));
}

function buildFavoritesCarousel(tours, languageManager) {
  const track = populateCardTrack('[data-favorites-track]', tours, languageManager);
  const viewport = track?.closest('.favorites-carousel')?.querySelector('.favorites-carousel__viewport');
  if (viewport) {
    viewport.scrollLeft = 0;
  }
}

function setupCardCarousels() {
  const carousels = document.querySelectorAll('[data-card-carousel]');
  if (!carousels.length) return;

  carousels.forEach((carousel) => {
    if (carousel.dataset.carouselReady === 'true') {
      if (typeof carousel._updateArrowState === 'function') {
        carousel._updateArrowState();
      }
      return;
    }

    const viewport = carousel.querySelector('.favorites-carousel__viewport');
    const track = carousel.querySelector('.favorites-carousel__track');
    const prevButton = carousel.querySelector('[data-carousel-arrow="prev"]');
    const nextButton = carousel.querySelector('[data-carousel-arrow="next"]');

    if (!viewport || !track) return;

    const getGap = () => {
      const styles = window.getComputedStyle(track);
      const gapValue = parseFloat(styles.columnGap || styles.gap || '0');
      return Number.isFinite(gapValue) ? gapValue : 0;
    };

    const updateArrowState = () => {
      const maxScroll = Math.max(0, viewport.scrollWidth - viewport.clientWidth);
      const atStart = viewport.scrollLeft <= 1;
      const atEnd = viewport.scrollLeft >= maxScroll - 1;

      if (prevButton) {
        prevButton.disabled = atStart;
      }
      if (nextButton) {
        nextButton.disabled = atEnd;
      }

      carousel.classList.toggle('favorites-carousel--is-scrollable', maxScroll > 1);
    };

    const scrollByDirection = (direction) => {
      const multiplier = direction < 0 ? -1 : 1;
      const card = track.querySelector('.favorite-card');
      const cardWidth = card ? card.getBoundingClientRect().width : viewport.clientWidth;
      const target = viewport.scrollLeft + multiplier * (cardWidth + getGap());
      const maxScroll = viewport.scrollWidth - viewport.clientWidth;
      const clamped = Math.max(0, Math.min(target, maxScroll));
      viewport.scrollTo({ left: clamped, behavior: 'smooth' });
    };

    prevButton?.addEventListener('click', () => scrollByDirection(-1));
    nextButton?.addEventListener('click', () => scrollByDirection(1));

    let scrollRaf = null;
    const handleScroll = () => {
      if (scrollRaf) return;
      scrollRaf = window.requestAnimationFrame(() => {
        scrollRaf = null;
        updateArrowState();
      });
    };

    viewport.addEventListener('scroll', handleScroll, { passive: true });

    let resizeRaf = null;
    const handleResize = () => {
      if (resizeRaf) return;
      resizeRaf = window.requestAnimationFrame(() => {
        resizeRaf = null;
        updateArrowState();
      });
    };

    window.addEventListener('resize', handleResize);

    updateArrowState();
    carousel.dataset.carouselReady = 'true';
    carousel._updateArrowState = updateArrowState;
  });
}

const mediaPreloadSources = new Set();
let mediaPreloadObserver = null;

function preloadImageSource(source) {
  if (!source || mediaPreloadSources.has(source)) return;
  const image = new Image();
  image.decoding = 'async';
  image.src = source;
  mediaPreloadSources.add(source);
}

function getMediaPreloadObserver() {
  if (mediaPreloadObserver || typeof IntersectionObserver === 'undefined') {
    return mediaPreloadObserver;
  }

  mediaPreloadObserver = new IntersectionObserver(
    (entries, observer) => {
      entries.forEach((entry) => {
        if (!entry.isIntersecting) return;
        const target = entry.target;
        observer.unobserve(target);

        if (target instanceof HTMLImageElement) {
          const source = target.currentSrc || target.src;
          preloadImageSource(source);
        }
      });
    },
    {
      rootMargin: '240px 0px',
      threshold: 0.01
    }
  );

  return mediaPreloadObserver;
}

function setupMediaPrefetch() {
  const lazyImages = document.querySelectorAll('img[loading="lazy"]:not([data-preload-ready])');
  if (!lazyImages.length) return;

  const observer = getMediaPreloadObserver();
  lazyImages.forEach((image) => {
    image.dataset.preloadReady = 'true';
    if (observer) {
      observer.observe(image);
    } else {
      preloadImageSource(image.currentSrc || image.src);
    }
  });
}

function setupTourGallery(gallery) {
  if (!gallery) return;

  const track = gallery.querySelector('[data-tour-gallery-track]');
  const prevButton = gallery.querySelector('[data-gallery-arrow="prev"]');
  const nextButton = gallery.querySelector('[data-gallery-arrow="next"]');
  const slides = track ? Array.from(track.children) : [];
  let current = 0;

  const update = () => {
    if (!track) return;
    track.style.transform = `translate3d(-${current * 100}%, 0, 0)`;
    const disableArrows = slides.length <= 1;
    if (prevButton) prevButton.disabled = disableArrows;
    if (nextButton) nextButton.disabled = disableArrows;
  };

  const goTo = (direction) => {
    if (!slides.length) return;
    current = (current + direction + slides.length) % slides.length;
    update();
  };

  prevButton?.addEventListener('click', () => goTo(-1));
  nextButton?.addEventListener('click', () => goTo(1));

  update();
}

function initTourPage(tours, languageManager) {
  const tourPage = document.querySelector('[data-tour-page]');
  if (!tourPage || !tours.length) return;

  const params = new URLSearchParams(window.location.search);
  const slug = params.get('tour') || tourPage.dataset.defaultTour;
  const baseTour = tours.find((item) => item.slug === slug) || tours[0];
  if (!baseTour) return;

  const galleryTrack = document.querySelector('[data-tour-gallery-track]');
  const galleryWrapper = document.querySelector('[data-tour-gallery]');
  const titleEl = document.querySelector('[data-tour-title]');
  const durationEl = document.querySelector('[data-tour-duration]');
  const taglineEl = document.querySelector('[data-tour-tagline]');
  const descriptionEl = document.querySelector('[data-tour-description]');
  const includesEl = document.querySelector('[data-tour-includes]');
  const priceEl = document.querySelector('[data-tour-price]');
  const guestSelect = document.querySelector('[data-tour-guests]');
  const bookingForm = document.querySelector('[data-tour-booking]');
  const noteEl = bookingForm?.querySelector('.tour-booking__note');
  const nameInput = document.querySelector('[data-tour-name]');
  const emailInput = document.querySelector('[data-tour-email]');
  const phoneInput = document.querySelector('[data-tour-phone]');
  const dateTimeInput = document.querySelector('[data-tour-datetime]');
  const dateTimeUnknown = document.querySelector('[data-tour-datetime-unknown]');
  const dateTimeField = document.querySelector('[data-tour-datetime-field]');
  const formspreeEndpoint = 'https://formspree.io/f/xkowoogr';

  const updateTourContent = (lang) => {
    const content = getTourContent(baseTour, lang);
    if (titleEl) titleEl.textContent = content.name;
    if (durationEl) durationEl.textContent = content.duration;
    if (taglineEl) taglineEl.innerHTML = content.tagline;
    if (descriptionEl) descriptionEl.textContent = content.description;
    document.title = `${content.name} | QuÃ©bec Mexique`;

    if (includesEl) {
      includesEl.innerHTML = '';
      content.includes.forEach((item) => {
        const cleanItem = item.replace(/^Â·\s*/, '');
        const li = document.createElement('li');
        li.textContent = cleanItem;
        includesEl.appendChild(li);
      });
    }

    if (galleryTrack) {
      const images = baseTour.gallery && baseTour.gallery.length ? baseTour.gallery : [baseTour.image];
      if (!galleryTrack.children.length) {
        galleryTrack.innerHTML = '';
        images.forEach((src, index) => {
          const isVideo = /\.(mov|mp4|webm)(\?.*)?$/i.test(src);
          const slide = document.createElement('figure');
          slide.className = 'tour-gallery__slide';
          slide.innerHTML = isVideo
            ? `<video src="${src}" autoplay muted loop playsinline preload="metadata"></video>`
            : `<img src="${src}" alt="Photo ${index + 1} de ${content.name}" loading="lazy" decoding="async" />`;
          galleryTrack.appendChild(slide);
        });
      } else {
        Array.from(galleryTrack.querySelectorAll('img')).forEach((image, index) => {
          image.alt = `${content.name} photo ${index + 1}`;
        });
      }
    }

    const relatedTours = tours.filter((item) => item.slug !== baseTour.slug);
    populateCardTrack('[data-related-track]', relatedTours, languageManager);
    setupCardCarousels();
  };

  updateTourContent(languageManager?.getLanguage() || DEFAULT_LANGUAGE);

  setupTourGallery(galleryWrapper);

  const buildGuestOptions = () => {
    if (!guestSelect) return;
    if (!baseTour.prices) return;

    const counts = Object.keys(baseTour.prices)
      .map((value) => Number(value))
      .filter((value) => Number.isFinite(value))
      .sort((a, b) => a - b);

    if (!counts.length) return;

    guestSelect.innerHTML = '';
    counts.forEach((count) => {
      const option = document.createElement('option');
      option.value = String(count);
      option.textContent = String(count);
      guestSelect.appendChild(option);
    });

    const defaultCount = counts.includes(2) ? 2 : counts[0];
    guestSelect.value = String(defaultCount);
  };

  buildGuestOptions();

  const updatePrice = () => {
    if (!priceEl || !guestSelect) return;
    const guests = Number(guestSelect.value) || 1;
    const price = baseTour.prices ? baseTour.prices[guests] : baseTour.basePrice;
    priceEl.textContent = currencyFormatter.format(price || 0);
  };

  guestSelect?.addEventListener('change', updatePrice);
  updatePrice();

  const toggleDateTime = () => {
    if (!dateTimeInput || !dateTimeUnknown) return;
    const isUnknown = dateTimeUnknown.checked;
    dateTimeInput.disabled = isUnknown;
    if (isUnknown) {
      dateTimeInput.value = '';
    }
  };

  dateTimeUnknown?.addEventListener('change', toggleDateTime);
  toggleDateTime();

  const openDateTimePicker = () => {
    if (!dateTimeInput || dateTimeInput.disabled) return;
    if (typeof dateTimeInput.showPicker === 'function') {
      dateTimeInput.showPicker();
    }
  };

  dateTimeInput?.addEventListener('click', openDateTimePicker);
  dateTimeInput?.addEventListener('focus', openDateTimePicker);
  dateTimeField?.addEventListener('click', (event) => {
    if (event.target instanceof HTMLInputElement && event.target.type === 'checkbox') return;
    openDateTimePicker();
    dateTimeInput?.focus();
  });

  bookingForm?.addEventListener('submit', (event) => {
    event.preventDefault();
    const lang = languageManager?.getLanguage() || DEFAULT_LANGUAGE;
    const tourContent = getTourContent(baseTour, lang);
    const guests = Number(guestSelect?.value) || 1;
    const pickupFallback = languageManager?.translate('tour.booking.pickupFallback', {}, lang) || 'your location';
    const pickup = (document.querySelector('[data-tour-pickup]')?.value || pickupFallback).trim();
    const name = (nameInput?.value || '').trim();
    const email = (emailInput?.value || '').trim();
    const phone = (phoneInput?.value || '').trim();
    const dateTimeValue = (dateTimeInput?.value || '').trim();
    const dateTimeUnknownLabel =
      languageManager?.translate('tour.booking.datetimeUnknown', {}, lang) || 'Not sure yet';
    const dateTimeFallback =
      languageManager?.translate('tour.booking.datetimeFallback', {}, lang) || 'Not provided';
    const dateTimeLabel = dateTimeUnknown?.checked ? dateTimeUnknownLabel : dateTimeValue || dateTimeFallback;
    if (noteEl) {
      noteEl.textContent =
        languageManager?.translate('tour.booking.status.hold', { guests, tour: tourContent.name, pickup }, lang) ||
        `Holding ${guests} spot(s) for ${tourContent.name}. We will confirm pick-up at ${pickup} right away.`;
    }
    if (!formspreeEndpoint || formspreeEndpoint.includes('REPLACE_ME')) {
      if (noteEl) {
        noteEl.textContent =
          languageManager?.translate('tour.booking.status.missingService', {}, lang) ||
          'Please connect the booking form to your email service to receive requests.';
      }
      return;
    }
    const payload = {
      tour: tourContent.name,
      guests,
      name: name || dateTimeFallback,
      email: email || dateTimeFallback,
      phone: phone || dateTimeFallback,
      dateTime: dateTimeLabel,
      pickup
    };
    fetch(formspreeEndpoint, {
      method: 'POST',
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(payload)
    })
      .then((response) => {
        if (!noteEl) return;
        noteEl.textContent = response.ok
          ? languageManager?.translate('tour.booking.status.sent', {}, lang) ||
            'Request sent! We will confirm availability and follow up right away.'
          : languageManager?.translate('tour.booking.status.error', {}, lang) ||
            'Something went wrong sending your request. Please try again shortly.';
      })
      .catch(() => {
        if (noteEl) {
          noteEl.textContent =
            languageManager?.translate('tour.booking.status.unavailable', {}, lang) ||
            'Unable to send your request right now. Please try again shortly.';
        }
      });
  });

  languageManager?.onChange(updateTourContent);
}

function setupInquiryForm(languageManager) {
  const form = document.querySelector('#custom-contact-form');
  const status = document.querySelector('#custom-contact-status');
  const formspreeEndpoint = 'https://formspree.io/f/xkowoogr';

  if (!form) return;

  const setStatus = (message = '', isError = false) => {
    if (!status) return;
    status.textContent = message;
    status.classList.toggle('is-error', Boolean(isError));
  };

  form.addEventListener('submit', (event) => {
    event.preventDefault();
    const formData = new FormData(form);
    const name = (formData.get('name') || '').toString().trim();
    const email = (formData.get('email') || '').toString().trim();
    const phone = (formData.get('phone') || '').toString().trim();
    const idea = (formData.get('idea') || '').toString().trim();

    if (!name || !email || !idea) {
      setStatus(languageManager.translate('inquiry.status.missing'), true);
      return;
    }

    if (!formspreeEndpoint || formspreeEndpoint.includes('REPLACE_ME')) {
      setStatus(languageManager.translate('inquiry.status.missingService'), true);
      return;
    }

    setStatus(languageManager.translate('inquiry.status.sending'));

    fetch(formspreeEndpoint, {
      method: 'POST',
      headers: {
        Accept: 'application/json'
      },
      body: formData
    })
      .then((response) => {
        if (response.ok) {
          setStatus(languageManager.translate('inquiry.status.sent'));
          form.reset();
          return;
        }
        setStatus(languageManager.translate('inquiry.status.error'), true);
      })
      .catch(() => {
        setStatus(languageManager.translate('inquiry.status.unavailable'), true);
      });
  });

  languageManager.onChange(() => setStatus(''));
}

function setCurrentYear() {
  const year = document.querySelector('#current-year');
  if (year) {
    year.textContent = new Date().getFullYear();
  }
}
